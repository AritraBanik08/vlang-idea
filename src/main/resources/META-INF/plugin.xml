<idea-plugin>
    <id>org.vlang</id>
    <name>Vlang</name>
    <vendor>Petr Makhnev</vendor>

    <description><![CDATA[
Vlang is a language plugin for IntelliJ IDEA that adds support for V language.
    ]]></description>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- V File -->
        <fileType name="V"
                  implementationClass="org.vlang.lang.VlangFileType"
                  fieldName="INSTANCE"
                  language="vlang"
                  extensions="v"/>

        <lang.parserDefinition language="vlang"
                               implementationClass="org.vlang.lang.VlangParserDefinition"/>

        <lang.syntaxHighlighterFactory language="vlang"
                                       implementationClass="org.vlang.lang.VlangSyntaxHighlighterFactory"/>

        <lang.commenter language="vlang" implementationClass="org.vlang.lang.VlangCommenter"/>

        <lang.braceMatcher language="vlang"
                           implementationClass="org.vlang.lang.VlangBraceMatcher"/>

        <lang.quoteHandler language="vlang"
                           implementationClass="org.vlang.lang.VlangQuoteHandler"/>

        <lang.foldingBuilder
          language="vlang"
          implementationClass="org.vlang.lang.folding.VlangFoldingBuilder"/>

        <lang.findUsagesProvider language="vlang"
                                 implementationClass="org.vlang.lang.usages.VlangFindUsagesProvider"/>

        <lang.smartEnterProcessor language="vlang"
                                  order="first"
                                  implementationClass="org.vlang.lang.VlangSmartEnterProcessor"/>

        <lang.formatter language="vlang" implementationClass="org.vlang.lang.formatter.VlangFormattingModelBuilder"/>
        <codeStyleSettingsProvider implementation="org.vlang.lang.formatter.VlangCodeStyleSettingsProvider"/>
        <langCodeStyleSettingsProvider implementation="org.vlang.lang.formatter.VlangLanguageCodeStyleSettingsProvider"/>

        <lang.importOptimizer language="vlang"
                              implementationClass="org.vlang.ide.codeInsight.imports.VlangImportOptimizer"/>
        <referenceImporter implementation="org.vlang.lang.psi.impl.imports.VlangReferenceImporter"/>
        <applicationService serviceImplementation="org.vlang.ide.codeInsight.imports.VlangCodeInsightSettings"/>

        <stubIndex implementation="org.vlang.lang.stubs.index.VlangModulesIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangFunctionIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangMethodIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangStructIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangUnionIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangEnumIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangTypeAliasIndex"/>
        <stubIndex implementation="org.vlang.lang.stubs.index.VlangNamesIndex"/>
        <stubElementTypeHolder class="org.vlang.lang.VlangTypes"/>

<!--        <codeInsight.inlayProvider language="vlang"-->
<!--                                   implementationClass="org.vlang.ide.hints.VlangInlayHintsProvider"/>-->
        <codeInsight.parameterNameHints language="vlang" id="VlangParameterNameHintsProvider"
                                        implementationClass="org.vlang.ide.hints.VlangParameterNameHintsProvider"/>
        <codeInsight.typeInfo language="vlang" implementationClass="org.vlang.ide.codeInsight.VlangTypeInfoProvider"/>
<!--        <typeDeclarationProvider implementation="com.goide.editor.GoTypeDeclarationProvider"/>-->

        <annotator language="vlang" order="first" id="org.vlang.lang.annotator.VlangAnnotator"
                   implementationClass="org.vlang.lang.annotator.VlangAnnotator"/>
        <documentationProvider implementation="org.vlang.ide.documentation.VlangDocumentationProvider"/>

        <lang.inspectionSuppressor language="vlang"
                                   implementationClass="org.vlang.ide.inspections.suppression.VlangInspectionSuppressor"/>

        <localInspection language="vlang" groupName="V" shortName="VlangUndefinedFunctionInspection"
                         displayName="Undefined function"
                         enabledByDefault="false" level="ERROR"
                         implementationClass="org.vlang.ide.inspections.VlangUndefinedFunctionInspection"/>

        <localInspection language="vlang" groupName="V" shortName="VlangUnresolvedLabelInspection"
                         displayName="Unresolved label"
                         enabledByDefault="true" level="ERROR"
                         implementationClass="org.vlang.ide.inspections.VlangUnresolvedLabelInspection"/>

        <localInspection language="vlang" groupName="V" shortName="VlangLabelOutsideUnsafeInspection"
                         displayName="Go to statement outside unsafe block"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.vlang.ide.inspections.VlangLabelOutsideUnsafeInspection"/>

        <localInspection language="vlang" groupName="V" shortName="VlangNilOutsideUnsafeInspection"
                         displayName="'nil' usage outside unsafe block"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.vlang.ide.inspections.VlangNilOutsideUnsafeInspection"/>

        <localInspection language="vlang" groupName="V" shortName="VlangVariableRedeclaration"
                         displayName="Variable redeclaration"
                         enabledByDefault="false" level="ERROR"
                         implementationClass="org.vlang.ide.inspections.VlangVariableRedeclarationInspection"/>

        <localInspection language="vlang" groupName="V" shortName="VlangUnresolvedReferenceUnsafeInspection"
                         displayName="Unresolved reference inspection"
                         enabledByDefault="true" level="ERROR"
                         implementationClass="org.vlang.ide.inspections.VlangUnresolvedReferenceInspection"/>

        <!-- Unused inspections -->
        <localInspection language="vlang" groupName="V" shortName="VlangUnusedParameterInspection"
                         displayName="Unused parameter inspection"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.vlang.ide.inspections.VlangUnusedParameterInspection"/>

       <localInspection language="vlang" groupName="V" shortName="VlangUnusedLabelInspection"
                         displayName="Unused label inspection"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.vlang.ide.inspections.VlangUnusedLabelInspection"/>

       <localInspection language="vlang" groupName="V" shortName="VlangUnusedImportInspection"
                         displayName="Unused import inspection"
                         enabledByDefault="true" level="WARNING"
                         implementationClass="org.vlang.ide.inspections.VlangUnusedImportInspection"/>

        <!-- Intentions -->
        <intentionAction>
            <className>org.vlang.ide.intentions.VlangMethodToFunctionIntention</className>
            <category>V</category>
        </intentionAction>

        <intentionAction>
            <className>org.vlang.ide.intentions.VlangFunctionToMethodIntention</className>
            <category>V</category>
        </intentionAction>
        <!-- End of Intentions -->

        <runLineMarkerContributor id="VlangRunLineMarkerProvider" language="vlang"
                                  implementationClass="org.vlang.ide.run.VlangRunLineMarkerProvider"/>

        <completion.contributor
          language="vlang"
          order="first"
          implementationClass="org.vlang.lang.completion.VlangClosureCompletionContributor"/>

        <completion.contributor
          language="vlang"
          implementationClass="org.vlang.lang.completion.VlangContextCompletionContributor"/>

        <completion.contributor
		      language="vlang"
		      implementationClass="org.vlang.lang.completion.VlangModuleNameCompletionContributor"/>

        <completion.contributor
          language="vlang"
          order="last"
          implementationClass="org.vlang.lang.completion.VlangKeywordsCompletionContributor"/>

      <typedHandler implementation="org.vlang.lang.completion.VlangTypedHandler"/>
        <enterHandlerDelegate implementation="org.vlang.lang.completion.VlangEnterHandlerDelegate"/>
        <backspaceHandlerDelegate order="first" implementation="org.vlang.lang.completion.VlangBackspaceHandlerDelegate"/>

        <formattingService implementation="org.vlang.lang.formatter.VlangFormattingService"/>

        <colorSettingsPage implementation="org.vlang.ide.highlight.VlangColorsAndFontsPage"/>

        <!--  Refactorings -->
        <statementUpDownMover implementation="org.vlang.ide.refactoring.VlangStatementUpDownMover"/>
        <lang.refactoringSupport language="vlang"
                                 implementationClass="org.vlang.ide.refactoring.VlangRefactoringSupportProvider"/>
        <!--  End of Refactorings -->
        <!-- End of V File -->

        <!-- Project -->
        <projectConfigurable groupId="language" instance="org.vlang.configurations.VlangProjectSettingsConfigurable"
                             id="MainVlangSettings"
                             dynamic="true" displayName="V"/>
        <projectConfigurable parentId="MainVlangSettings" instance="org.vlang.configurations.VlangFmtSettingsConfigurable"
                             id="org.vlang.configurations.VlangProjectSettingsConfigurable"
                             dynamic="true" displayName="Vfmt"/>
        <projectService serviceImplementation="org.vlang.configurations.VlangConfiguration"/>
        <projectService serviceImplementation="org.vlang.configurations.VlangProjectSettingsState"/>
        <projectService serviceImplementation="org.vlang.configurations.VlangFmtSettingsState"/>
        <moduleBuilder builderClass="org.vlang.projectWizard.VlangModuleBuilder"/>
        <postStartupActivity implementation="org.vlang.project.VlangPostStartupActivity"/>
        <indexableFilesContributor implementation="org.vlang.project.VlangIndexableFilesContributor"/>

        <fileDocumentManagerListener implementation="org.vlang.project.VlangFmtWatcher$VlangFmtListener"/>

        <!-- End of Project -->

        <notificationGroup id="V Plugin" displayType="BALLOON"/>

        <!-- SDK -->
        <sdkType implementation="org.vlang.sdk.VlangSdkType"/>
        <library.presentationProvider implementation="org.vlang.sdk.VlangLibraryPresentationProvider"/>
        <library.type implementation="org.vlang.sdk.VlangLibraryType"/>

        <projectService serviceImplementation="org.vlang.sdk.VlangSdkService"/>
        <moduleType id="V_MODULE" implementationClass="org.vlang.sdk.VlangModuleType"/>
        <moduleConfigurationEditorProvider implementation="org.vlang.configurations.VlangModuleEditorsProvider" order="first"/>
        <!-- End of SDK -->

        <!-- Run V script Configuration -->
        <configurationType implementation="org.vlang.ide.run.VlangRunConfigurationType"/>
        <runConfigurationProducer
          implementation="org.vlang.ide.run.VlangRunConfigurationProducer"/>

        <!-- V Mod File -->
        <fileType name="V Module"
                  implementationClass="org.vlang.vmod.VmodFileType"
                  fieldName="INSTANCE"
                  language="vmod"
                  fileNames="v.mod"/>

        <lang.parserDefinition language="vmod"
                               implementationClass="org.vlang.vmod.VmodParserDefinition"/>

        <lang.syntaxHighlighterFactory language="vmod"
                                       implementationClass="org.vlang.vmod.VmodSyntaxHighlighterFactory"/>

        <lang.commenter language="vmod" implementationClass="org.vlang.vmod.VmodCommenter"/>

        <lang.braceMatcher language="vmod"
                           implementationClass="org.vlang.vmod.VmodBraceMatcher"/>

        <lang.quoteHandler language="vmod"
                           implementationClass="org.vlang.vmod.VmodQuoteHandler"/>

        <annotator language="vmod" order="first" id="org.vlang.vmod.annotator.VmodAnnotator"
                   implementationClass="org.vlang.vmod.annotator.VmodAnnotator"/>

        <completion.contributor language="vmod"
                                implementationClass="org.vlang.vmod.completion.VmodCompletionContributor"/>
        <!-- End of V Mod File -->

        <!-- Tests -->
        <testSourcesFilter implementation="org.vlang.ide.test.VlangTestSourcesFilter"/>
        <runLineMarkerContributor id="VlangTestRunLineMarkerProvider" language="vlang"
                                  implementationClass="org.vlang.ide.test.configuration.VlangTestLineMarkerProvider"/>
        <configurationType implementation="org.vlang.ide.test.configuration.VlangTestConfigurationType"/>
        <runConfigurationProducer
          implementation="org.vlang.ide.test.configuration.VlangTestConfigurationProducer"/>
        <implicitUsageProvider implementation="org.vlang.ide.test.VlangTestImplicitUsageProvider"/>
        <!-- End of Tests -->

        <!-- Others -->
        <notificationGroup id="VlangNotifications" displayType="BALLOON"/>

        <additionalTextAttributes scheme="Default" file="colorSchemes/VlangAddonsDefault.xml"/>
        <additionalTextAttributes scheme="Darcula" file="colorSchemes/VlangAddonsDarcula.xml"/>

        <defaultLiveTemplates file="/liveTemplates/V.xml"/>
        <liveTemplateContext implementation="org.vlang.ide.templates.VlangTemplateContextType$Generic"/>
        <liveTemplateContext implementation="org.vlang.ide.templates.VlangTemplateContextType$TopLevel"/>
        <liveTemplateContext implementation="org.vlang.ide.templates.VlangTemplateContextType$Statement"/>
        <liveTemplateContext implementation="org.vlang.ide.templates.VlangTemplateContextType$Comment"/>

        <defaultTemplatePropertiesProvider implementation="org.vlang.ide.templates.VlangDefaultTemplatePropertiesProvider"/>
    </extensions>

    <actions>
        <action id="vlang.new.file" class="org.vlang.ide.actions.CreateVlangFileAction">
            <add-to-group group-id="NewGroup" anchor="before" relative-to-action="NewFile"/>
        </action>
    </actions>

</idea-plugin>
